# KICASecureKeypad 라이브러리 연동 가이드

앱(App)에서 `kicasecurekeypad` 라이브러리를 사용하는 방법을 쉽고 정확하게 설명해 드립니다.

---

## 1. 라이브러리 추가하기 (Dependencies)

`app/build.gradle.kts` 파일에 라이브러리 의존성을 추가하세요.

```kotlin
dependencies {
    // ... 기존 의존성들
    
    // KICA 보안 키패드 라이브러리 추가
    implementation(project(":kicasecurekeypad"))
}
```

> **참고**: `settings.gradle.kts`에 라이브러리 모듈(`:kicasecurekeypad`)이 include 되어 있어야 합니다.

---

## 2. 사용 방법 (Basic Usage)

`SecureKeypad` 컴포저블을 사용하여 키패드를 화면에 표시합니다.

### 2.1. 기본 코드 예시

```kotlin
import com.kica.android.secure.keypad.SecureKeypad
import com.kica.android.secure.keypad.domain.model.KeypadConfig
import com.kica.android.secure.keypad.domain.model.KeypadType

@Composable
fun MyScreen() {
    // ... 상태 변수들
    var maskedInput by remember { mutableStateOf("") }

    // 보안 키패드 화면 표시
    SecureKeypad(
        modifier = Modifier.fillMaxWidth(),
        
        // 1. 설정 (Config)
        config = KeypadConfig(
            type = KeypadType.ALPHANUMERIC, // 키패드 종류 (숫자/문자)
            enableHapticFeedback = true,    // 진동 효과 켜기
            enableEncryption = true         // 암호화 사용
        ),
        
        // 2. 입력 콜백 (Event Callbacks)
        onKeyPressed = { maskedValue -> 
            // 사용자가 키를 누를 때마다 호출됨 (예: "●●●")
            maskedInput = maskedValue
        },
        onComplete = { encryptedValue ->
            // '완료' 또는 '확인' 버튼을 눌렀을 때 호출됨
            // 암호화된 최종 입력값이 전달됩니다.
            println("입력 완료: $encryptedValue")
        },
        onError = { errorMessage ->
            // 에러 발생 시 호출됨
            println("에러: $errorMessage")
        }
    )
}
```

---

## 3. 설정 옵션 상세 (KeypadConfig)

`KeypadConfig` 클래스를 통해 키패드의 동작과 디자인을 설정할 수 있습니다.

| 옵션명 | 타입 | 기본값 | 설명 |
|---|---|---|---|
| `type` | `KeypadType` | `NUMERIC` | `NUMERIC`(숫자), `ALPHANUMERIC`(문자), `ENGLISH`, `KOREAN` 중 선택 |
| `colors` | `KeypadColors` | 기본값 | 키패드 색상 설정 (배경, 버튼색, 글자색 등) |
| `maxLength` | `Int` | 20 | 최대 입력 가능 길이 |
| `showMasking` | `Boolean` | `true` | 상단 입력창 표시 여부 |
| `maskingChar` | `Char` | `*` | 마스킹에 사용할 문자 (예: '●') |
| `randomizeLayout` | `Boolean` | `true` | 숫자 키패드 재배열(보안) 기능 사용 여부 |
| `enableEncryption` | `Boolean` | `false` | 입력값 암호화 여부 |

> **다크 모드 지원**: `KeypadColors`를 별도로 지정하지 않으면(`default()` 사용 시), 스마트폰 시스템 설정이 다크 모드일 때 **자동으로 다크 테마 색상**이 적용됩니다.

### 색상 커스터마이징 예시 (Toss 스타일)

```kotlin
config = KeypadConfig(
    colors = KeypadColors(
        backgroundColor = Color(0xFFF2F4F6),
        buttonColor = Color.White,
        buttonTextColor = Color(0xFF191F28),
        specialButtonColor = Color(0xFFE5E8EB), // 기능키 색상
        confirmButtonColor = Color(0xFF3182F6)  // 확인 버튼 색상 (파랑)
    )
)
```

---

## 4. 이벤트 처리 (Event Handling)

*   **`onKeyPressed`**: 사용자가 키를 누를 때마다 실행됩니다. 주로 화면에 마스킹된 문자(`***`)를 보여주는 용도로 사용합니다. **주의: 보안을 위해 실제 입력값은 전달되지 않습니다.**
*   **`onComplete`**: 사용자가 입력을 마치고 '확인/완료' 버튼을 눌렀을 때 실행됩니다. 이때 **최종 입력값(또는 암호화된 값)**이 전달됩니다. 서버로 전송하거나 처리를 시작하는 시점입니다.
*   **`onError`**: 키패드 내부에서 오류가 발생했을 때 실행됩니다. 사용자에게 토스트 메시지나 스낵바를 띄워주세요.

---

## 5. 키패드 타입 (Keypad Types)

| 타입 | 설명 | 용도 |
|---|---|---|
| `KeypadType.NUMERIC` | 숫자 전용 키패드 (보안 키패드) | PIN 번호, 계좌비밀번호 입력 |
| `KeypadType.ALPHANUMERIC` | 영문/한글/숫자/특수문자 모두 지원 | 아이디, 비밀번호, 일반 텍스트 입력 |
| `KeypadType.ENGLISH` | 영문 전용 키패드 | 영문 이름 등 입력 |
| `KeypadType.KOREAN` | 한글 전용 키패드 | 한글 이름 등 입력 |

> **팁**: `ALPHANUMERIC` 타입을 사용하면, 사용자가 키패드 내에서 한/영 변환 및 특수문자 모드로 자유롭게 전환할 수 있어 가장 범용적입니다.
